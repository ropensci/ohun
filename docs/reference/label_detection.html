<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Label detections from a sound event detection procedure — label_detection • ohun</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Label detections from a sound event detection procedure — label_detection" />
<meta property="og:description" content="label_detection labels the performance of a sound event detection procedure comparing the output selection table to a reference selection table" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ohun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ohun.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maRce10/ohun/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Label detections from a sound event detection procedure</h1>
    <small class="dont-index">Source: <a href='https://github.com/maRce10/ohun/blob/master/R/label_detection.R'><code>R/label_detection.R</code></a></small>
    <div class="hidden name"><code>label_detection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>label_detection</code> labels the performance of a sound event detection procedure comparing the output selection table to a reference selection table</p>
    </div>

    <pre class="usage"><span class='fu'>label_detection</span><span class='op'>(</span><span class='va'>reference</span>, <span class='va'>detection</span>, cores <span class='op'>=</span> <span class='fl'>1</span>, pb <span class='op'>=</span> <span class='cn'>TRUE</span>, min.overlap <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>reference</th>
      <td><p>Data frame or 'selection.table' (following the warbleR package format) with the reference selections (start and end of the sound events) that will be used to evaluate the performance of the detection, represented by those selections in 'detection'. Must contained at least the following columns: "sound.files", "selec", "start" and "end". <strong>It must contain the reference selections that will be used for detection optimization</strong>.</p></td>
    </tr>
    <tr>
      <th>detection</th>
      <td><p>Data frame or 'selection.table' with the detections (start and end of the sound events) that will be compared against the 'reference' selections. Must contained at least the following columns: "sound.files", "selec", "start" and "end". It can contain data for additional sound files not found in 'references'. In this case the routine assumes that no sound events are found in those files, so detection from those files are all false positives.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Numeric. Controls whether parallel computing is applied.
It specifies the number of cores to be used. Default is 1 (i.e. no parallel computing).</p></td>
    </tr>
    <tr>
      <th>pb</th>
      <td><p>Logical argument to control progress bar. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>min.overlap</th>
      <td><p>Numeric. Controls the minimum amount of overlap required for a detection and a reference sound for it to be counted as true positive. Default is 0.5. Overlap is measured as intersection over union.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame or selection table (if 'detection' was also a selection table, warbleR package's format, see <code><a href='https://marce10.github.io/warbleR/reference/selection_table.html'>selection_table</a></code>) including two additional columns, 'detection.class', which indicates the class of each detection and 'overlap' which refers to the amount overlap to the reference sound. See <code><a href='diagnose_detection.html'>diagnose_detection</a></code> for a description of the labels used in 'detection.class'. The output data frame also contains an additional data frame with the overlap for each pair of overlapping detection/reference.  Overlap is measured as intersection over union.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function identifies the rows in the output of a detection routine as true or false positives. This is achieved by comparing the data frame to a reference selection table in which all sound events of interest have been selected.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas, M., Smith-Vidaurre, G., Chaverri, G., Brenes, J. C., Chirino, F., Elizondo-Calvo, J., &amp; Rico-Guevara, A. 2022. ohun: an R package for diagnosing and optimizing automatic sound event detection. BioRxiv, 2022.12.13.520253. https://doi.org/10.1101/2022.12.13.520253</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='diagnose_detection.html'>diagnose_detection</a></code>, <code><a href='summarize_diagnostic.html'>summarize_diagnostic</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Marcelo Araya-Salas <a href='mailto:marcelo.araya@ucr.ac.cr'>marcelo.araya@ucr.ac.cr</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='op'>{</span>
  <span class='co'># load data</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lbh_reference"</span><span class='op'>)</span>

  <span class='co'># an extra one in detection (1 false positive)</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>lbh_reference</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>]</span>, detection <span class='op'>=</span> <span class='va'>lbh_reference</span><span class='op'>)</span>

  <span class='co'># missing one in detection (all true positives)</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>lbh_reference</span>, detection <span class='op'>=</span> <span class='va'>lbh_reference</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>

  <span class='co'># perfect detection (all true positives)</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>lbh_reference</span>, detection <span class='op'>=</span> <span class='va'>lbh_reference</span><span class='op'>)</span>

  <span class='co'># and extra sound file in reference (all true positives)</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>
    reference <span class='op'>=</span> <span class='va'>lbh_reference</span>, detection <span class='op'>=</span>
      <span class='va'>lbh_reference</span><span class='op'>[</span><span class='va'>lbh_reference</span><span class='op'>$</span><span class='va'>sound.files</span> <span class='op'>!=</span> <span class='st'>"lbh1.wav"</span>, <span class='op'>]</span>
  <span class='op'>)</span>

  <span class='co'># and extra sound file in detection (some false positives)</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>
    reference <span class='op'>=</span>
      <span class='va'>lbh_reference</span><span class='op'>[</span><span class='va'>lbh_reference</span><span class='op'>$</span><span class='va'>sound.files</span> <span class='op'>!=</span> <span class='st'>"lbh1.wav"</span>, <span class='op'>]</span>,
    detection <span class='op'>=</span> <span class='va'>lbh_reference</span>
  <span class='op'>)</span>

  <span class='co'># duplicate 1 detection row (to get 2 splits)</span>
  <span class='va'>detec</span> <span class='op'>&lt;-</span> <span class='va'>lbh_reference</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>lbh_reference</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='op'>]</span>
  <span class='va'>detec</span><span class='op'>$</span><span class='va'>selec</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1.2</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>
    reference <span class='op'>=</span> <span class='va'>lbh_reference</span>,
    detection <span class='op'>=</span> <span class='va'>detec</span>
  <span class='op'>)</span>

  <span class='co'># merge 2 detections (to get split and merge)</span>
  <span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='va'>lbh_reference</span>
  <span class='va'>Y</span><span class='op'>$</span><span class='va'>end</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1.2</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>lbh_reference</span>, detection <span class='op'>=</span> <span class='va'>Y</span><span class='op'>)</span>

  <span class='co'># remove split to get only merge</span>
  <span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='va'>Y</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>2</span>, <span class='op'>]</span>
  <span class='fu'>label_detection</span><span class='op'>(</span>reference <span class='op'>=</span> <span class='va'>lbh_reference</span>, detection <span class='op'>=</span> <span class='va'>Y</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span style='color: #000000;'>Object of class </span><span style='color: #000000; font-weight: bold;'>'selection_table' 
#&gt; </span><span style='color: #555555;'>* The output of the following call: 
#&gt; </span><span style='color: #555555; font-style: italic;'>label_detection(reference = lbh_reference, detection = Y) 
#&gt; </span><span style='color: #555555; font-weight: bold;'>
#&gt; Contains:</span><span style='color: #555555;'> 
#&gt; *  A selection table data frame with 18 rows and 8 columns: 
#&gt; |sound.files | selec|  start|    end| bottom.freq| top.freq|
#&gt; |:-----------|-----:|------:|------:|-----------:|--------:|
#&gt; |lbh2.wav    |     1| 0.1092| 1.2000|      2.2954|   8.9382|
#&gt; |lbh2.wav    |     3| 1.2658| 1.3856|      2.2606|   9.0774|
#&gt; |lbh2.wav    |     4| 1.8697| 2.0053|      2.1911|   8.9035|
#&gt; |lbh2.wav    |     5| 2.4418| 2.5809|      2.1563|   8.6600|
#&gt; |lbh2.wav    |     6| 3.0368| 3.1689|      2.2259|   8.9382|
#&gt; |lbh2.wav    |     7| 3.6286| 3.7466|      2.3302|   8.6252|
#&gt; ... 2 more column(s) (detection.class, overlap) and 12 more row(s) 
#&gt; 
#&gt;  * A data frame (check.results) generated by check_sels() (as attribute) 
#&gt; created by warbleR &lt; 1.1.21</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


